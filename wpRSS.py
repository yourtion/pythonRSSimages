#!/usr/bin/env python# -*- coding: UTF-8 -*-import sysreload(sys)sys.setdefaultencoding("utf-8")# 解析 Feed 的库import feedparser# 解析 html xml 的库from bs4 import BeautifulSoupimport urllib2from os.path import basenamefrom urlparse import urlsplitimport ostry:    feed_ = feedparser.parse("feed.xml")    count = len(feed_['entries'])    counts = [i for i in range(count)]    #文章标题    #titles = [feed_.entries[x].title for x in counts]    #print titles	#文章作者    #authors = [feed_.entries[x].author for x in counts]    #print feed_.entries[0].author    #文章内容    #descriptions = [feed_.entries[x].content for x in counts]    #print descriptions    #content = [descriptions[x][0].value for x in counts]    #print content    title =  feed_.entries[0].title    author = feed_.entries[0].author    save_path = 'imgs/' + author + "/" + title    if not os.path.exists(save_path):    # 创建用来保存图片的文件夹        os.makedirs(save_path)    #print feed_.entries[0].content[0].value    #description_soup = beautifulsoup(''.join(feed_.entries[0].content[0].value))    cont = feed_.entries[0].content[0].value    #print cont    imc = BeautifulSoup(cont)    #print imc    #print len(imc.find_all('img'))    i=0    for i in range(len(imc.find_all('img'))):        img_src = imc.find_all('img')[i]['src']        #print img_src        ## 下载图片        try:            imgData = urllib2.urlopen(img_src).read()            # 获取图片名称            print basename(urlsplit(img_src)[2])            fileName = save_path + '/' + basename(urlsplit(img_src)[2])            print fileName            # 如果文件名已存在            #if os.path.exists(fileName):            #    continue            output = open(fileName,'wb')            output.write(imgData)            output.close()            print "Finished download", img_src        except:            print "Download %s failed" %img_src    #description_soup = beautifulsoup(''.join(descriptions))    #img_src = [description_soup.findAll('img')[x]['src'] for x in counts]    #print img_srcexcept:    print 'RSS 源有问题，请检查！'    exit()